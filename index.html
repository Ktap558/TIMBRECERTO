

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timbre Certo</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap');
        
        * {
            box-sizing: border-box;
        }
        
        body { 
            margin: 0; 
            font-family: 'Rajdhani', sans-serif; 
            background: #0a0a0a;
            color: #f0f0f0; 
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(90deg, rgba(255, 152, 0, 0.03) 1px, transparent 1px),
                linear-gradient(rgba(255, 152, 0, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
        }
        
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 15% 85%, rgba(255, 152, 0, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 85% 15%, rgba(255, 152, 0, 0.05) 0%, transparent 40%);
            pointer-events: none;
            z-index: -1;
        }
        
        header { 
            background: linear-gradient(135deg, #111111 0%, #1e1e1e 50%, #2a2a2a 100%);
            padding: 25px; 
            text-align: center; 
            font-family: 'Orbitron', monospace;
            font-size: 2.8em; 
            font-weight: 900;
            color: #ff9800;
            border-bottom: 3px solid #ff9800;
            position: relative;
            overflow: hidden;
            clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
        }
        
        header::before {
            content: '01001000 01100101 01101100 01101100 01101111';
            position: absolute;
            top: 5px;
            right: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: rgba(255, 152, 0, 0.3);
            animation: matrix-flow 8s linear infinite;
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #ff9800, transparent);
            animation: progress-scan 2s ease-in-out infinite;
        }
        
        @keyframes matrix-flow {
            0% { transform: translateX(100px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateX(-100px); opacity: 0; }
        }
        
        @keyframes progress-scan {
            0%, 100% { transform: scaleX(0); }
            50% { transform: scaleX(1); }
        }
        
        .container { 
            padding: 25px; 
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }
        
        .card { 
            background: linear-gradient(145deg, #111111, #1e1e1e);
            margin: 15px 0; 
            padding: 25px; 
            border-radius: 0px; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid #333333;
            border-left: 4px solid #ff9800;
            position: relative;
            overflow: hidden;
            clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 15px, 100% 100%, 15px 100%, 0 calc(100% - 15px));
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #ff9800, transparent);
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }
        
        .card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #ff9800, transparent);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .card:hover::after {
            transform: scaleX(1);
        }
        
        .card:hover { 
            background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
            transform: translateY(-3px) translateX(3px);
            border-color: #ff9800;
            box-shadow: 
                -5px 5px 15px rgba(0, 0, 0, 0.7),
                0 0 0 1px rgba(255, 152, 0, 0.3);
        }
        
        button { 
            padding: 14px 25px; 
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: #000000; 
            border: 2px solid #ff9800; 
            border-radius: 0px; 
            cursor: pointer; 
            transition: all 0.3s ease;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
            clip-path: polygon(10px 0, 100% 0, calc(100% - 10px) 100%, 0 100%);
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        button:hover::before {
            transform: translateX(100%);
        }
        
        button:hover { 
            background: linear-gradient(135deg, #f57c00, #e65100);
            transform: translateX(3px);
            box-shadow: -3px 3px 10px rgba(0, 0, 0, 0.5);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .search-bar {
            width: 100%;
            padding: 18px 25px;
            margin: 30px 0;
            background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
            border: 2px solid #333333;
            border-left: 4px solid #ff9800;
            border-radius: 0px;
            color: #f0f0f0;
            font-size: 18px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
            transition: all 0.3s ease;
            clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
        }
        
        .search-bar:focus {
            outline: none;
            border-color: #ff9800;
            background: linear-gradient(145deg, #111111, #222222);
            transform: translateX(2px);
        }
        
        .search-bar::placeholder {
            color: rgba(255, 152, 0, 0.5);
            font-style: italic;
        }
        
        .brand-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .tone-list {
            margin: 30px 0;
        }
        
        .tone-item {
            background: linear-gradient(145deg, #1e1e1e, #2c2c2c);
            margin: 15px 0;
            padding: 25px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 152, 0, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .tone-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #ff9800, #f57c00);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .tone-item:hover::before {
            transform: scaleY(1);
        }
        
        .tone-item:hover {
            border-color: rgba(255, 152, 0, 0.5);
            box-shadow: 0 5px 20px rgba(255, 152, 0, 0.1);
        }
        
        .tone-info h3 {
            margin: 0 0 8px 0;
            color: #ff9800;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 20px;
        }
        
        .tone-info p {
            margin: 0 0 12px 0;
            color: #ccc;
            font-size: 16px;
            line-height: 1.4;
        }
        
        .price {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: #000000;
            padding: 10px 20px;
            border-radius: 0px;
            font-size: 14px;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            border: 2px solid #ff9800;
            clip-path: polygon(8px 0, 100% 0, calc(100% - 8px) 100%, 0 100%);
            letter-spacing: 1px;
        }
        
        .back-btn {
            background: linear-gradient(135deg, #555, #666);
            margin-bottom: 25px;
        }
        
        .back-btn:hover {
            background: linear-gradient(135deg, #666, #777);
            box-shadow: 0 5px 15px rgba(85, 85, 85, 0.4);
        }
        
        .hidden {
            display: none;
        }
        
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }
        
        .admin-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #1e1e1e, #2c2c2c);
            padding: 35px;
            border-radius: 15px;
            min-width: 350px;
            border: 2px solid rgba(255, 152, 0, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7);
        }
        
        .admin-input {
            width: 100%;
            padding: 12px 16px;
            margin: 12px 0;
            background: linear-gradient(145deg, #0a0a0a, #1c1c1c);
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 8px;
            color: #f0f0f0;
            font-family: 'Rajdhani', sans-serif;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .admin-input:focus {
            outline: none;
            border-color: #ff9800;
            box-shadow: 0 0 10px rgba(255, 152, 0, 0.2);
        }
        
        .footer {
            margin-top: 60px;
            padding: 25px;
            border-top: 2px solid rgba(255, 152, 0, 0.2);
            text-align: center;
            color: #888;
            font-size: 14px;
            background: linear-gradient(135deg, #0a0a0a, #1a1a1a);
        }
        
        .admin-trigger {
            opacity: 0.3;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Orbitron', monospace;
            font-size: 16px;
            color: #ff9800;
            padding: 5px 10px;
            border: 1px solid transparent;
        }
        
        .admin-trigger:hover {
            opacity: 1;
            border-color: #ff9800;
            background: rgba(255, 152, 0, 0.1);
        }
        
        .whatsapp-btn {
            background: linear-gradient(135deg, #25d366, #1da851);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .whatsapp-btn:hover {
            background: linear-gradient(135deg, #1da851, #128c3e);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4);
        }
        
        .brand-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #ff9800, #f57c00);
            border-radius: 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 28px;
            margin: 0 auto 15px;
            font-family: 'Orbitron', monospace;
            color: #000000;
            border: 3px solid #ff9800;
            transition: all 0.3s ease;
            clip-path: polygon(15px 0, 100% 0, calc(100% - 15px) 100%, 0 100%);
            position: relative;
        }
        
        .brand-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 15px;
            height: 15px;
            background: #ff9800;
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }
        
        .card:hover .brand-icon {
            transform: scale(1.05) rotate(2deg);
            background: linear-gradient(135deg, #f57c00, #e65100);
        }
        
        .tone-count {
            color: #ff9800;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Orbitron', monospace;
        }
        
        h2 {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            color: #ff9800;
            margin-bottom: 25px;
            position: relative;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 50px;
            height: 3px;
            background: #ff9800;
        }
        
        h3 {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #ff9800;
            font-family: 'Orbitron', monospace;
        }
        
        .loading::after {
            content: '...';
            animation: loading-dots 1.5s infinite;
        }
        
        @keyframes loading-dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        .error {
            background: rgba(211, 47, 47, 0.1);
            border: 1px solid #d32f2f;
            color: #ff6b6b;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .success {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid #4caf50;
            color: #81c784;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        🎸 Timbre Certo
    </header>

    <div class="container">
        <input 
            type="text" 
            placeholder="Buscar pedaleira ou modelo..."
            class="search-bar"
            id="searchInput"
            oninput="filterContent()"
        >
        
        <!-- Loading State -->
        <div id="loadingState" class="loading">
            Carregando dados
        </div>
        
        <!-- Brands Section -->
        <section id="brandsSection" class="hidden">
            <h2 style="text-align: center; margin: 30px 0;">Escolha sua Marca de Pedaleira</h2>
            <div class="brand-grid" id="brandGrid">
                <!-- Brands will be populated here -->
            </div>
        </section>

        <!-- Models Section -->
        <section id="modelsSection" class="hidden">
            <button onclick="showBrands()" class="back-btn">← Voltar</button>
            <h2>Modelos <span id="brandName"></span></h2>
            <div id="modelsList" class="model-grid">
                <!-- Models will be populated here -->
            </div>
        </section>

        <!-- Tones Section -->
        <section id="tonesSection" class="hidden">
            <button onclick="goBack()" class="back-btn">← Voltar</button>
            <h2>Timbres Disponíveis</h2>
            <p id="modelInfo" style="color: #ccc; margin-bottom: 20px;"></p>
            <div id="tonesList" class="tone-list">
                <!-- Tones will be populated here -->
            </div>
        </section>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>&copy; 2024 Timbre Certo. Todos os direitos reservados.</p>
        <span class="admin-trigger" onclick="toggleAdmin()">•••</span>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel">
        <div class="admin-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
            <h3>Painel Administrativo</h3>
            <div id="loginForm">
                <input type="password" placeholder="Digite a senha..." class="admin-input" id="adminPassword">
                <button onclick="adminLogin()">Entrar</button>
                <button onclick="toggleAdmin()" style="background: #555; margin-left: 10px;">Cancelar</button>
            </div>
            
            <!-- Admin Menu -->
            <div id="adminMenu" class="hidden">
                <button onclick="showAdminSection('brands')" style="width: 100%; margin: 5px 0; background: #007acc;">Gerenciar Marcas</button>
                <button onclick="showAdminSection('models')" style="width: 100%; margin: 5px 0; background: #7c4dff;">Gerenciar Modelos</button>
                <button onclick="showAdminSection('tones')" style="width: 100%; margin: 5px 0;">Gerenciar Timbres</button>
                <button onclick="toggleAdmin()" style="width: 100%; margin: 5px 0; background: #555;">Sair</button>
            </div>

            <!-- Brands Management -->
            <div id="adminBrands" class="hidden">
                <button onclick="showAdminMenu()" class="back-btn" style="margin-bottom: 15px;">← Voltar</button>
                <h4>Gerenciar Marcas</h4>
                
                <div style="margin: 15px 0; padding: 15px; background: #1c1c1c; border-radius: 5px;">
                    <h5>Adicionar Nova Marca</h5>
                    <input type="text" placeholder="Nome da marca" class="admin-input" id="newBrandName">
                    <input type="text" placeholder="Ícone (ex: Z, B, L6)" class="admin-input" id="newBrandIcon">
                    <button onclick="addBrand()" id="addBrandBtn">Adicionar Marca</button>
                </div>
                
                <div id="brandsList">
                    <!-- Brands list will be populated here -->
                </div>
            </div>

            <!-- Models Management -->
            <div id="adminModels" class="hidden">
                <button onclick="showAdminMenu()" class="back-btn" style="margin-bottom: 15px;">← Voltar</button>
                <h4>Gerenciar Modelos</h4>
                
                <div style="margin: 15px 0; padding: 15px; background: #1c1c1c; border-radius: 5px;">
                    <h5>Adicionar Novo Modelo</h5>
                    <select class="admin-input" id="modelBrandSelect">
                        <option value="">Selecione uma marca</option>
                    </select>
                    <input type="text" placeholder="Nome do modelo" class="admin-input" id="newModelName">
                    <input type="text" placeholder="ID do modelo (ex: g1x)" class="admin-input" id="newModelId">
                    <button onclick="addModel()" id="addModelBtn">Adicionar Modelo</button>
                </div>
                
                <div id="modelsList">
                    <!-- Models list will be populated here -->
                </div>
            </div>

            <!-- Tones Management -->
            <div id="adminTones" class="hidden">
                <button onclick="showAdminMenu()" class="back-btn" style="margin-bottom: 15px;">← Voltar</button>
                <h4>Gerenciar Timbres</h4>
                
                <div style="margin: 15px 0; padding: 15px; background: #1c1c1c; border-radius: 5px;">
                    <h5>Adicionar Novo Timbre</h5>
                    <input type="text" placeholder="Nome do timbre" class="admin-input" id="newToneName">
                    <input type="text" placeholder="Descrição" class="admin-input" id="newToneDescription">
                    <input type="text" placeholder="Preço (ex: R$ 15,00)" class="admin-input" id="newTonePrice">
                    <button onclick="addTone()" id="addToneBtn">Adicionar Timbre</button>
                </div>
                
                <div id="tonesListAdmin">
                    <!-- Tones list will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBDVBhJhcpyy756a-ONHa1SF2XaZQ0xLhg",
            authDomain: "timbre-certo.firebaseapp.com",
            projectId: "timbre-certo",
            storageBucket: "timbre-certo.firebasestorage.app",
            messagingSenderId: "303658016178",
            appId: "1:303658016178:web:db00bd8e6eb598330a18ab",
            measurementId: "G-5L6DHD44QP"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const analytics = firebase.analytics();

        // Initialize app when page loads
        window.addEventListener('load', () => {
            initializeTimbreCerto();
        });
    </script>

    <script>
        let currentBrand = '';
        let currentModel = '';
        let navigationHistory = [];
        let brandsData = {};
        let modelsData = {};
        let tonesData = {};

        // Initialize the application
        async function initializeTimbreCerto() {
            try {
                showLoading(true);
                await loadAllData();
                showLoading(false);
                showBrands();
            } catch (error) {
                console.error('Error initializing app:', error);
                showError('Erro ao carregar dados. Tente novamente.');
                showLoading(false);
            }
        }

        // Load all data from Firebase
        async function loadAllData() {
            try {
                // Load brands
                const brandsSnapshot = await db.collection('brands').get();
                brandsData = {};
                brandsSnapshot.forEach((doc) => {
                    brandsData[doc.id] = { id: doc.id, ...doc.data() };
                });

                // Load models
                const modelsSnapshot = await db.collection('models').get();
                modelsData = {};
                modelsSnapshot.forEach((doc) => {
                    const data = doc.data();
                    if (!modelsData[data.brandId]) {
                        modelsData[data.brandId] = [];
                    }
                    modelsData[data.brandId].push({ id: doc.id, ...data });
                });

                // Load tones
                const tonesSnapshot = await db.collection('tones').get();
                tonesData = {};
                tonesSnapshot.forEach((doc) => {
                    tonesData[doc.id] = { id: doc.id, ...doc.data() };
                });

                // If no data exists, create default data
                if (Object.keys(brandsData).length === 0) {
                    await createDefaultData();
                }

            } catch (error) {
                console.error('Error loading data:', error);
                throw error;
            }
        }

        // Create default data if none exists
        async function createDefaultData() {
            try {
                // Default brands
                const defaultBrands = [
                    { name: 'Zoom', icon: 'Z' },
                    { name: 'Boss', icon: 'B' },
                    { name: 'Line 6', icon: 'L6' },
                    { name: 'Cuvave', icon: 'CV' },
                    { name: 'MK300', icon: 'MK' },
                    { name: 'TC Electronic', icon: 'TC' }
                ];

                // Add brands to Firebase
                for (const brand of defaultBrands) {
                    const docRef = await db.collection('brands').add(brand);
                    brandsData[docRef.id] = { id: docRef.id, ...brand };
                }

                // Default models
                const brandIds = Object.keys(brandsData);
                const defaultModels = [
                    { brandId: brandIds[0], name: 'G1X Four', modelId: 'g1x' },
                    { brandId: brandIds[0], name: 'G3', modelId: 'g3' },
                    { brandId: brandIds[1], name: 'GT-1', modelId: 'gt1' },
                    { brandId: brandIds[1], name: 'ME-80', modelId: 'me80' },
                    { brandId: brandIds[2], name: 'HX Stomp', modelId: 'hx' },
                    { brandId: brandIds[2], name: 'POD Go', modelId: 'pod' }
                ];

                // Add models to Firebase
                for (const model of defaultModels) {
                    const docRef = await db.collection('models').add(model);
                    if (!modelsData[model.brandId]) {
                        modelsData[model.brandId] = [];
                    }
                    modelsData[model.brandId].push({ id: docRef.id, ...model });
                }

                // Default tones
                const defaultTones = [
                    { name: 'Clean Worship', description: 'Ideal para base em músicas lentas e adoração', price: 'R$ 15,00' },
                    { name: 'Rock Clássico', description: 'Timbre vintage para rock dos anos 70-80', price: 'R$ 18,00' },
                    { name: 'Metal Moderno', description: 'High gain para metal contemporâneo', price: 'R$ 20,00' },
                    { name: 'Blues Vintage', description: 'Timbre quente para blues tradicional', price: 'R$ 16,00' },
                    { name: 'Pop/Rock', description: 'Versátil para pop rock e indie', price: 'R$ 17,00' },
                    { name: 'Jazz Fusion', description: 'Timbre limpo com compressão para jazz', price: 'R$ 19,00' }
                ];

                // Add tones to Firebase
                for (const tone of defaultTones) {
                    const docRef = await db.collection('tones').add(tone);
                    tonesData[docRef.id] = { id: docRef.id, ...tone };
                }

            } catch (error) {
                console.error('Error creating default data:', error);
                throw error;
            }
        }

        // Show/hide loading state
        function showLoading(show) {
            const loadingState = document.getElementById('loadingState');
            if (show) {
                loadingState.classList.remove('hidden');
            } else {
                loadingState.classList.add('hidden');
            }
        }

        // Show error message
        function showError(message) {
            const container = document.querySelector('.container');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            container.insertBefore(errorDiv, container.firstChild);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }

        // Show success message
        function showSuccess(message) {
            const container = document.querySelector('.container');
            const successDiv = document.createElement('div');
            successDiv.className = 'success';
            successDiv.textContent = message;
            container.insertBefore(successDiv, container.firstChild);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        function showModels(brandId) {
            currentBrand = brandId;
            navigationHistory.push('brands');
            
            document.getElementById('brandsSection').classList.add('hidden');
            document.getElementById('modelsSection').classList.remove('hidden');
            
            const brand = brandsData[brandId];
            document.getElementById('brandName').textContent = brand ? brand.name : 'Marca';
            
            const modelsList = document.getElementById('modelsList');
            const models = modelsData[brandId] || [];
            
            modelsList.innerHTML = models.map(model => `
                <div class="card" onclick="showTones('${model.id}', '${model.name}')">
                    <h3>${model.name}</h3>
                    <p class="tone-count">${Object.keys(tonesData).length} timbres</p>
                    <p style="color: #ccc; font-size: 14px;">Timbres profissionais testados</p>
                </div>
            `).join('');
        }

        function showTones(modelId, modelName) {
            currentModel = modelId;
            navigationHistory.push('models');
            
            document.getElementById('modelsSection').classList.add('hidden');
            document.getElementById('tonesSection').classList.remove('hidden');
            
            const brand = brandsData[currentBrand];
            document.getElementById('modelInfo').textContent = `${brand ? brand.name : 'Marca'} ${modelName}`;
            
            const tonesList = document.getElementById('tonesList');
            const tones = Object.values(tonesData);
            
            tonesList.innerHTML = tones.map(tone => `
                <div class="tone-item">
                    <div class="tone-info">
                        <h3>${tone.name}</h3>
                        <p>${tone.description}</p>
                        <span class="price">${tone.price}</span>
                    </div>
                    <button onclick="openWhatsApp('${tone.name}')" class="whatsapp-btn">
                        📱 Liberar Acesso
                    </button>
                </div>
            `).join('');
        }

        function openWhatsApp(toneName) {
            const brand = brandsData[currentBrand];
            const modelInfo = `${brand ? brand.name : 'Marca'} ${currentModel}`;
            const message = `👋 Olá! Tenho interesse no timbre *${toneName}* para a pedaleira *${modelInfo}*. Como posso liberar o acesso?`;
            const whatsappUrl = `https://wa.me/5597984582107?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function showBrands() {
            navigationHistory = [];
            document.getElementById('modelsSection').classList.add('hidden');
            document.getElementById('tonesSection').classList.add('hidden');
            document.getElementById('brandsSection').classList.remove('hidden');
            
            updateBrandsDisplay();
        }

        function updateBrandsDisplay() {
            const brandGrid = document.getElementById('brandGrid');
            const brands = Object.values(brandsData);
            
            brandGrid.innerHTML = brands.map(brand => {
                const modelCount = modelsData[brand.id] ? modelsData[brand.id].length : 0;
                return `
                    <div class="card brand-card" onclick="showModels('${brand.id}')">
                        <div class="brand-icon">${brand.icon}</div>
                        <h3>${brand.name}</h3>
                        <p class="tone-count">${modelCount} modelos</p>
                    </div>
                `;
            }).join('');
        }

        function goBack() {
            const lastPage = navigationHistory.pop();
            if (lastPage === 'models') {
                document.getElementById('tonesSection').classList.add('hidden');
                document.getElementById('modelsSection').classList.remove('hidden');
            } else {
                showBrands();
            }
        }

        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            if (panel.style.display === 'block') {
                panel.style.display = 'none';
            } else {
                panel.style.display = 'block';
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('adminMenu').classList.add('hidden');
                document.getElementById('adminBrands').classList.add('hidden');
                document.getElementById('adminModels').classList.add('hidden');
                document.getElementById('adminTones').classList.add('hidden');
                document.getElementById('adminPassword').value = '';
            }
        }

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'Wer123&@') {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('adminMenu').classList.remove('hidden');
            } else {
                alert('Senha incorreta!');
            }
        }

        function showAdminMenu() {
            document.getElementById('adminBrands').classList.add('hidden');
            document.getElementById('adminModels').classList.add('hidden');
            document.getElementById('adminTones').classList.add('hidden');
            document.getElementById('adminMenu').classList.remove('hidden');
        }

        function showAdminSection(section) {
            document.getElementById('adminMenu').classList.add('hidden');
            document.getElementById('adminBrands').classList.add('hidden');
            document.getElementById('adminModels').classList.add('hidden');
            document.getElementById('adminTones').classList.add('hidden');
            
            if (section === 'brands') {
                document.getElementById('adminBrands').classList.remove('hidden');
                loadBrandsList();
            } else if (section === 'models') {
                document.getElementById('adminModels').classList.remove('hidden');
                loadModelsList();
                loadBrandOptions();
            } else if (section === 'tones') {
                document.getElementById('adminTones').classList.remove('hidden');
                loadTonesList();
            }
        }

        function loadBrandsList() {
            const brandsList = document.getElementById('brandsList');
            const brands = Object.values(brandsData);
            
            brandsList.innerHTML = brands.map(brand => {
                const modelCount = modelsData[brand.id] ? modelsData[brand.id].length : 0;
                return `
                    <div style="background: #1c1c1c; padding: 10px; margin: 5px 0; border-radius: 5px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${brand.name}</strong>
                            <span style="color: #ccc; margin-left: 10px;">(${modelCount} modelos)</span>
                        </div>
                        <button onclick="deleteBrand('${brand.id}')" style="background: #d32f2f; padding: 5px 10px;">Excluir</button>
                    </div>
                `;
            }).join('');
        }

        function loadModelsList() {
            const modelsList = document.getElementById('modelsList');
            let allModels = [];
            
            Object.keys(modelsData).forEach(brandId => {
                const brand = brandsData[brandId];
                modelsData[brandId].forEach(model => {
                    allModels.push({...model, brandName: brand ? brand.name : 'Marca'});
                });
            });
            
            modelsList.innerHTML = allModels.map(model => `
                <div style="background: #1c1c1c; padding: 10px; margin: 5px 0; border-radius: 5px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>${model.name}</strong>
                        <span style="color: #ccc; margin-left: 10px;">${model.brandName}</span>
                    </div>
                    <button onclick="deleteModel('${model.id}')" style="background: #d32f2f; padding: 5px 10px;">Excluir</button>
                </div>
            `).join('');
        }

        function loadTonesList() {
            const tonesList = document.getElementById('tonesListAdmin');
            const tones = Object.values(tonesData);
            
            tonesList.innerHTML = tones.map(tone => `
                <div style="background: #1c1c1c; padding: 15px; margin: 5px 0; border-radius: 5px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                        <div style="flex: 1;">
                            <input type="text" value="${tone.name}" class="admin-input" id="tone-name-${tone.id}" style="margin-bottom: 5px;">
                            <input type="text" value="${tone.description}" class="admin-input" id="tone-desc-${tone.id}" style="margin-bottom: 5px;">
                            <input type="text" value="${tone.price}" class="admin-input" id="tone-price-${tone.id}">
                        </div>
                        <div style="margin-left: 10px;">
                            <button onclick="updateTone('${tone.id}')" style="background: #4caf50; padding: 5px 10px; margin-bottom: 5px; display: block;">Salvar</button>
                            <button onclick="deleteTone('${tone.id}')" style="background: #d32f2f; padding: 5px 10px;">Excluir</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadBrandOptions() {
            const select = document.getElementById('modelBrandSelect');
            const brands = Object.values(brandsData);
            
            select.innerHTML = '<option value="">Selecione uma marca</option>' + 
                brands.map(brand => `<option value="${brand.id}">${brand.name}</option>`).join('');
        }

        async function addBrand() {
            const name = document.getElementById('newBrandName').value.trim();
            const icon = document.getElementById('newBrandIcon').value.trim();
            const btn = document.getElementById('addBrandBtn');
            
            if (!name || !icon) {
                alert('Preencha todos os campos!');
                return;
            }
            
            try {
                btn.disabled = true;
                btn.textContent = 'Adicionando...';
                
                const docRef = await db.collection('brands').add({
                    name: name,
                    icon: icon
                });
                
                brandsData[docRef.id] = { id: docRef.id, name: name, icon: icon };
                
                document.getElementById('newBrandName').value = '';
                document.getElementById('newBrandIcon').value = '';
                
                loadBrandsList();
                updateBrandsDisplay();
                showSuccess('Marca adicionada com sucesso!');
                
            } catch (error) {
                console.error('Error adding brand:', error);
                showError('Erro ao adicionar marca. Tente novamente.');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Adicionar Marca';
            }
        }

        async function addModel() {
            const brandId = document.getElementById('modelBrandSelect').value;
            const name = document.getElementById('newModelName').value.trim();
            const modelId = document.getElementById('newModelId').value.trim().toLowerCase();
            const btn = document.getElementById('addModelBtn');
            
            if (!brandId || !name || !modelId) {
                alert('Preencha todos os campos!');
                return;
            }
            
            try {
                btn.disabled = true;
                btn.textContent = 'Adicionando...';
                
                const docRef = await db.collection('models').add({
                    brandId: brandId,
                    name: name,
                    modelId: modelId
                });
                
                if (!modelsData[brandId]) {
                    modelsData[brandId] = [];
                }
                modelsData[brandId].push({ id: docRef.id, brandId: brandId, name: name, modelId: modelId });
                
                document.getElementById('newModelName').value = '';
                document.getElementById('newModelId').value = '';
                document.getElementById('modelBrandSelect').value = '';
                
                loadModelsList();
                updateBrandsDisplay();
                showSuccess('Modelo adicionado com sucesso!');
                
            } catch (error) {
                console.error('Error adding model:', error);
                showError('Erro ao adicionar modelo. Tente novamente.');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Adicionar Modelo';
            }
        }

        async function addTone() {
            const name = document.getElementById('newToneName').value.trim();
            const description = document.getElementById('newToneDescription').value.trim();
            const price = document.getElementById('newTonePrice').value.trim();
            const btn = document.getElementById('addToneBtn');
            
            if (!name || !description || !price) {
                alert('Preencha todos os campos!');
                return;
            }
            
            try {
                btn.disabled = true;
                btn.textContent = 'Adicionando...';
                
                const docRef = await db.collection('tones').add({
                    name: name,
                    description: description,
                    price: price
                });
                
                tonesData[docRef.id] = { id: docRef.id, name: name, description: description, price: price };
                
                document.getElementById('newToneName').value = '';
                document.getElementById('newToneDescription').value = '';
                document.getElementById('newTonePrice').value = '';
                
                loadTonesList();
                showSuccess('Timbre adicionado com sucesso!');
                
            } catch (error) {
                console.error('Error adding tone:', error);
                showError('Erro ao adicionar timbre. Tente novamente.');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Adicionar Timbre';
            }
        }

        async function updateTone(toneId) {
            const newName = document.getElementById(`tone-name-${toneId}`).value.trim();
            const newDesc = document.getElementById(`tone-desc-${toneId}`).value.trim();
            const newPrice = document.getElementById(`tone-price-${toneId}`).value.trim();
            
            if (!newName || !newDesc || !newPrice) {
                alert('Preencha todos os campos!');
                return;
            }
            
            try {
                await db.collection('tones').doc(toneId).update({
                    name: newName,
                    description: newDesc,
                    price: newPrice
                });
                
                tonesData[toneId] = { id: toneId, name: newName, description: newDesc, price: newPrice };
                
                showSuccess('Timbre atualizado com sucesso!');
                
            } catch (error) {
                console.error('Error updating tone:', error);
                showError('Erro ao atualizar timbre. Tente novamente.');
            }
        }

        async function deleteBrand(brandId) {
            if (confirm('Tem certeza que deseja excluir esta marca e todos os seus modelos?')) {
                try {
                    // Delete all models of this brand first
                    if (modelsData[brandId]) {
                        for (const model of modelsData[brandId]) {
                            await db.collection('models').doc(model.id).delete();
                        }
                        delete modelsData[brandId];
                    }
                    
                    // Delete the brand
                    await db.collection('brands').doc(brandId).delete();
                    delete brandsData[brandId];
                    
                    loadBrandsList();
                    updateBrandsDisplay();
                    showSuccess('Marca excluída com sucesso!');
                    
                } catch (error) {
                    console.error('Error deleting brand:', error);
                    showError('Erro ao excluir marca. Tente novamente.');
                }
            }
        }

        async function deleteModel(modelId) {
            if (confirm('Tem certeza que deseja excluir este modelo?')) {
                try {
                    await db.collection('models').doc(modelId).delete();
                    
                    // Remove from local data
                    Object.keys(modelsData).forEach(brandId => {
                        modelsData[brandId] = modelsData[brandId].filter(model => model.id !== modelId);
                    });
                    
                    loadModelsList();
                    updateBrandsDisplay();
                    showSuccess('Modelo excluído com sucesso!');
                    
                } catch (error) {
                    console.error('Error deleting model:', error);
                    showError('Erro ao excluir modelo. Tente novamente.');
                }
            }
        }

        async function deleteTone(toneId) {
            if (confirm('Tem certeza que deseja excluir este timbre?')) {
                try {
                    await db.collection('tones').doc(toneId).delete();
                    delete tonesData[toneId];
                    
                    loadTonesList();
                    showSuccess('Timbre excluído com sucesso!');
                    
                } catch (error) {
                    console.error('Error deleting tone:', error);
                    showError('Erro ao excluir timbre. Tente novamente.');
                }
            }
        }

        function filterContent() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const brandCards = document.querySelectorAll('.brand-card');
            
            brandCards.forEach(card => {
                const brandName = card.querySelector('h3').textContent.toLowerCase();
                if (brandName.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'975302c14193d94e',t:'MTc1NjIwNzk2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

